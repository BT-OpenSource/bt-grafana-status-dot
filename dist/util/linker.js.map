{"version":3,"sources":["../../src/util/linker.js"],"names":["Linker","panel","linkSrv","dots","forEach","_createScope","_populateScope","_evaluateLink","dot","scope","Object","assign","scopedVars","linkScope","linkVars","value","name","split","variable","index","links","linkInfo","linkIndex","undefined","linkFn","getPanelLinkAnchorInfo","link"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wBAAaA,M;AACX,wBAAaC,KAAb,EAAoBC,OAApB,EAA6B;AAAA;;AAC3B,eAAKD,KAAL,GAAaA,KAAb;AACA,eAAKC,OAAL,GAAeA,OAAf;AACD;;;;+BAEKC,I,EAAM;AACVA,iBAAKC,OAAL,CAAa,KAAKC,YAAlB,EAAgC,IAAhC;AACAF,iBAAKC,OAAL,CAAa,KAAKE,cAAlB,EAAkC,IAAlC;AACAH,iBAAKC,OAAL,CAAa,KAAKG,aAAlB,EAAiC,IAAjC;AACD;;;uCAEaC,G,EAAK;AACjB,gBAAIC,QAAQC,OAAOC,MAAP,CAAc,EAAd,EAAkB,KAAKV,KAAL,CAAWW,UAA7B,CAAZ;AACAJ,gBAAIK,SAAJ,GAAgBJ,KAAhB;AACD;;;yCAEeD,G,EAAK;AACnB,iBAAKP,KAAL,CAAWa,QAAX,CAAoBV,OAApB,CAA4B,oBAAY;AACtC,kBAAIW,QAAQP,IAAIQ,IAAJ,CAASC,KAAT,CAAe,GAAf,EAAoBC,SAASC,KAA7B,CAAZ;AACAX,kBAAIK,SAAJ,CAAcK,SAASF,IAAvB,IAA+B,EAAED,OAAOA,KAAT,EAA/B;AACD,aAHD;AAID;;;wCAEcP,G,EAAK;AAClB,gBAAIY,QAAQ,KAAKnB,KAAL,CAAWmB,KAAX,IAAoB,EAAhC;AACA,gBAAIC,WAAWD,MAAM,KAAKnB,KAAL,CAAWqB,SAAjB,CAAf;;AAEA,gBAAID,aAAaE,SAAjB,EAA4B;;AAE5B,gBAAIC,SAAS,KAAKtB,OAAL,CAAauB,sBAA1B;AACAjB,gBAAIkB,IAAJ,GAAWF,OAAOH,QAAP,EAAiBb,IAAIK,SAArB,CAAX;AACD","file":"linker.js","sourcesContent":["export class Linker {\n  constructor (panel, linkSrv) {\n    this.panel = panel\n    this.linkSrv = linkSrv\n  }\n\n  call (dots) {\n    dots.forEach(this._createScope, this)\n    dots.forEach(this._populateScope, this)\n    dots.forEach(this._evaluateLink, this)\n  }\n\n  _createScope (dot) {\n    var scope = Object.assign({}, this.panel.scopedVars)\n    dot.linkScope = scope\n  }\n\n  _populateScope (dot) {\n    this.panel.linkVars.forEach(variable => {\n      var value = dot.name.split('.')[variable.index]\n      dot.linkScope[variable.name] = { value: value }\n    })\n  }\n\n  _evaluateLink (dot) {\n    var links = this.panel.links || []\n    var linkInfo = links[this.panel.linkIndex]\n\n    if (linkInfo === undefined) return\n\n    var linkFn = this.linkSrv.getPanelLinkAnchorInfo\n    dot.link = linkFn(linkInfo, dot.linkScope)\n  }\n}\n"]}