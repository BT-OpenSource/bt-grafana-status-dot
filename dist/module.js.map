{"version":3,"sources":["../src/module.js"],"names":["_","kbn","MetricsPanelCtrl","Builder","Presenter","panelDefaults","radius","defaultColor","thresholds","format","decimals","TrendDotCtrl","$scope","$injector","defaults","panel","events","on","onInitEditMode","bind","onDataReceived","onRender","builder","presenter","addEditorTab","unitFormats","getUnitFormats","seriesList","render","dots","call","subitem","value","push","color","index","splice","dot","formatFunc","valueFormats","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACOA,O;;AACAC,S;;AACCC,sB,kBAAAA,gB;;AACAC,a,gBAAAA,O;;AACAC,e,kBAAAA,S;;;;;;;;;;;;;;;;;;;;;AAEFC,mB,GAAgB;AACpBC,gBAAQ,MADY;AAEpBC,sBAAc,oBAFM;AAGpBC,oBAAY,EAHQ;AAIpBC,gBAAQ,MAJY;AAKpBC,kBAAU;AALU,O;;mDAQTC,Y;;;AACX,8BAAaC,MAAb,EAAqBC,SAArB,EAAgC;AAAA;;AAAA,kIACxBD,MADwB,EAChBC,SADgB;;AAE9Bb,YAAEc,QAAF,CAAW,MAAKC,KAAhB,EAAuBV,aAAvB;;AAEA,gBAAKW,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKC,cAAL,CAAoBC,IAApB,OAAjC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKG,cAAL,CAAoBD,IAApB,OAAhC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,MAAKI,QAAL,CAAcF,IAAd,OAAzB;;AAEA,gBAAKG,OAAL,GAAe,IAAInB,OAAJ,CAAY,MAAKY,KAAjB,CAAf;AACA,gBAAKQ,SAAL,GAAiB,IAAInB,SAAJ,CAAc,MAAKW,KAAnB,CAAjB;AAT8B;AAU/B;;;;2CAEiB;AAChB,iBAAKS,YAAL,CAAkB,SAAlB,EAA6B,kDAA7B;AACA,iBAAKC,WAAL,GAAmBxB,IAAIyB,cAAJ,EAAnB;AACD;;;yCAEeC,U,EAAY;AAC1B,iBAAKA,UAAL,GAAkBA,UAAlB;AACA,iBAAKC,MAAL;AACD;;;qCAEW;AACV,iBAAKC,IAAL,GAAY,KAAKP,OAAL,CAAaQ,IAAb,CAAkB,KAAKH,UAAvB,CAAZ;AACA,iBAAKJ,SAAL,CAAeO,IAAf,CAAoB,KAAKD,IAAzB;AACD;;;4CAEkBE,O,EAAS;AAC1B,iBAAKhB,KAAL,CAAWN,MAAX,GAAoBsB,QAAQC,KAA5B;AACA,iBAAKJ,MAAL;AACD;;;iDAEuB;AACtB,iBAAKb,KAAL,CAAWP,UAAX,CAAsByB,IAAtB,CAA2B,EAAED,OAAO,CAAT,EAAYE,OAAO,KAAKnB,KAAL,CAAWR,YAA9B,EAA3B;AACA,iBAAKqB,MAAL;AACD;;;kDAEwBO,K,EAAO;AAC9B,iBAAKpB,KAAL,CAAWP,UAAX,CAAsB4B,MAAtB,CAA6BD,KAA7B,EAAoC,CAApC;AACA,iBAAKP,MAAL;AACD;;;mCAESS,G,EAAK;AACb,mBAAO,EAAE,cAAcA,IAAIH,KAApB,EAA2B,SAAS,KAAKnB,KAAL,CAAWT,MAA/C,EAAuD,UAAU,KAAKS,KAAL,CAAWT,MAA5E,EAAP;AACD;;;iCAEO0B,K,EAAmC;AAAA,gBAA5BvB,OAA4B,uEAAnB,KAAKM,KAAL,CAAWN,MAAQ;;AACzC,gBAAI6B,aAAarC,IAAIsC,YAAJ,CAAiB9B,OAAjB,CAAjB;AACA,mBAAO6B,WAAWN,KAAX,EAAkB,KAAKjB,KAAL,CAAWL,QAA7B,EAAuC,IAAvC,CAAP;AACD;;;;QAlD+BR,gB;;;;AAqDlCS,mBAAa6B,WAAb,GAA2B,aAA3B;;2BACS7B,Y","file":"module.js","sourcesContent":["import './module.css!'\nimport _ from 'lodash'\nimport kbn from 'app/core/utils/kbn'\nimport {MetricsPanelCtrl} from 'app/plugins/sdk'\nimport {Builder} from './util/builder'\nimport {Presenter} from './util/presenter'\n\nconst panelDefaults = {\n  radius: '20px',\n  defaultColor: 'rgb(117, 117, 117)',\n  thresholds: [],\n  format: 'none',\n  decimals: 2\n}\n\nexport class TrendDotCtrl extends MetricsPanelCtrl {\n  constructor ($scope, $injector) {\n    super($scope, $injector)\n    _.defaults(this.panel, panelDefaults)\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this))\n    this.events.on('data-received', this.onDataReceived.bind(this))\n    this.events.on('render', this.onRender.bind(this))\n\n    this.builder = new Builder(this.panel)\n    this.presenter = new Presenter(this.panel)\n  }\n\n  onInitEditMode () {\n    this.addEditorTab('Options', 'public/plugins/btplc-trend-dot-panel/editor.html')\n    this.unitFormats = kbn.getUnitFormats()\n  }\n\n  onDataReceived (seriesList) {\n    this.seriesList = seriesList\n    this.render()\n  }\n\n  onRender () {\n    this.dots = this.builder.call(this.seriesList)\n    this.presenter.call(this.dots)\n  }\n\n  onEditorSetFormat (subitem) {\n    this.panel.format = subitem.value\n    this.render()\n  }\n\n  onEditorAddThreshold () {\n    this.panel.thresholds.push({ value: 0, color: this.panel.defaultColor })\n    this.render()\n  }\n\n  onEditorRemoveThreshold (index) {\n    this.panel.thresholds.splice(index, 1)\n    this.render()\n  }\n\n  styleFor (dot) {\n    return { 'background': dot.color, 'width': this.panel.radius, 'height': this.panel.radius }\n  }\n\n  format (value, format = this.panel.format) {\n    var formatFunc = kbn.valueFormats[format]\n    return formatFunc(value, this.panel.decimals, null)\n  }\n}\n\nTrendDotCtrl.templateUrl = 'module.html'\nexport { TrendDotCtrl as PanelCtrl }\n"]}